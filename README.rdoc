## Minh's notes

Features that I picked to work on:
 - User security

### User security
#### Reason
I picked to work on this problem because I think security issues are very important and interesting.
#### Description
In this feature, I modeled a very simple encryption method using a 8 bytes `salt` string to generate a password using SHA2 (Secure Hash Algorithm 2). The `salt` and `encrypted_password` strings are saved in the `user` record.

When a user forgets his/her password, they can go to the `reset_password` page to enter their email, the reset instructions will be sent to that email. The instruction will include a link with a `reset_token` which will be expired (set to `nil`) after a successful password reset occurred. Clicking on the reset password link will direct them to the page where they can enter the new password and save it.

I deleted the `password` column and added a callback in the `User` model so that every time we call:

```
user.update password: 'new-password'
```
the password will be encrypted and saved to the database in the `encrypted_password` column.
#### Future optimization
I will combine these 2 columns (`salt` and `encrypted_password`) into one and store the `salt` as the first 12 chars of the `encrypted_password` (we need `4*(n/3)` to represent `n` bytes - so 8 bytes will need 12 chars to represent)

#### Roadblocks
No major roadblocks.
#### Estimation accuracy
Time estimation: 8 hours. Actual time needed: 10 hours. Time spent: new code base, refactor, set up tools (email sending, test helpers...), actual feature implementation.

#### Running instructions
Since I removed the `password` column inside the `users` table and added a few columns for password encryption, password reset token and email, please run:

```
rake db:drop
rake db:create
rake db:seed
```
To start the app
```
rails s
```
To run the test suite
```
rspec
```

--------

= portrait

Portrait is a web service which converts a website into a image. The actual hard work is handled by Google's {Puppeteer}[https://github.com/GoogleChrome/puppeteer].  Portrait is primarily designed to be used as a service, but does have a minimal admin interface.

== Dependencies
You'll need to be able to run Puppeteer via Node.js. You'll also need to be able to run a Rails stack. Portrait is built on Ruby 2.3.3 and Rails 5.2

== Installation

The provided setup script should take care of all the necessities: installing dependencies, setting up a database, and creating a temporary admin user.

  $ ./bin/setup

Once that completes successfully, spin up a rails server

  $ rails server

And visit http://localhost:3000

== How it works

Send a POST request like below. Use basic http authorization and provide a parameter named +site[url]+. You can test it with curl:

  curl -X POST -d "site[url]=https://google.com" -H "Accept: application/json" http://admin:admin@localhost:3000/sites

On a valid url, you'll get a json response like this:

  {
    "site": {
      "id": 1,
      "status": "succeeded",
      "image": {
        "url": ".../1.png"
      }
    }
  }

== Author

* portrait was created by Jordan McKible http://jordan.mckible.com

* Available on GitHub http://github.com/techvalidate/portrait
